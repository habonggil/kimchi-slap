<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ê¹€ì¹˜ì‹¸ë‹¤êµ¬ - ì² í•™ìê°€ ëŒ€ì‹  ë•Œë ¤ë“œë¦½ë‹ˆë‹¤! ìŠ¤íŠ¸ë ˆìŠ¤ë¥¼ ì² í•™ìœ¼ë¡œ ë‚ ë ¤ë²„ë¦¬ì„¸ìš”!">
    <meta property="og:title" content="ê¹€ì¹˜ì‹¸ë‹¤êµ¬ - ì² í•™ìê°€ ëŒ€ì‹  ë•Œë ¤ë“œë¦½ë‹ˆë‹¤">
    <meta property="og:description" content="ë‹ˆì²´, ì¹¸íŠ¸, ì†Œí¬ë¼í…ŒìŠ¤ê°€ ë‹¹ì‹ ì„ ëŒ€ì‹ í•´ ê¹€ì¹˜ì‹¸ë‹¤êµ¬ë¥¼!">
    <title>ê¹€ì¹˜ì‹¸ë‹¤êµ¬ - ì² í•™ìê°€ ëŒ€ì‹  ë•Œë ¤ë“œë¦½ë‹ˆë‹¤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(to bottom, #fee2e2, #ffffff);
            min-height: 100vh;
            padding: 1rem;
        }
        
        .container {
            max-width: 448px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 2rem;
            padding-top: 2rem;
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: bold;
            color: #dc2626;
            margin-bottom: 0.5rem;
        }
        
        .header p {
            color: #6b7280;
        }
        
        .card {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .btn {
            background: #dc2626;
            color: white;
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 9999px;
            font-size: 1.125rem;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .btn:hover {
            background: #b91c1c;
        }
        
        .btn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }
        
        .btn-secondary {
            background: #6b7280;
        }
        
        .btn-secondary:hover {
            background: #4b5563;
        }
        
        .btn-success {
            background: #10b981;
        }
        
        .btn-success:hover {
            background: #059669;
        }
        
        .text-red { color: #dc2626; font-weight: bold; }
        .text-gray { color: #6b7280; }
        .text-sm { font-size: 0.875rem; }
        .text-lg { font-size: 1.125rem; }
        .text-2xl { font-size: 1.5rem; }
        .text-6xl { font-size: 3.75rem; }
        .text-center { text-align: center; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-3 { margin-bottom: 0.75rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mt-4 { margin-top: 1rem; }
        .font-bold { font-weight: bold; }
        
        .target-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .target-btn {
            padding: 1.5rem;
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }
        
        .target-btn:hover {
            border-color: #dc2626;
            background: #fee2e2;
        }
        
        .target-btn.selected {
            border-color: #dc2626;
            background: #fee2e2;
        }
        
        .target-btn .emoji {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }
        
        .input-group {
            margin-bottom: 1rem;
        }
        
        .input-group input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            font-size: 1rem;
        }
        
        .input-group input:focus {
            outline: none;
            border-color: #dc2626;
        }
        
        .philosopher-list {
            max-height: 24rem;
            overflow-y: auto;
            margin-bottom: 1rem;
        }
        
        .philosopher-item {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 0.75rem;
            text-align: left;
            display: flex;
            align-items: center;
        }
        
        .philosopher-item:hover {
            border-color: #dc2626;
            background: #fee2e2;
        }
        
        .philosopher-item.premium {
            border-color: #fbbf24;
            background: #fef3c7;
            opacity: 0.75;
        }
        
        .philosopher-item .emoji {
            font-size: 2rem;
            margin-right: 1rem;
        }
        
        .philosopher-item .name {
            font-weight: bold;
            margin-bottom: 0.25rem;
        }
        
        .philosopher-item .quote {
            font-size: 0.875rem;
            color: #6b7280;
        }
        
        .premium-badge {
            background: #fbbf24;
            color: white;
            font-size: 0.75rem;
            padding: 0.125rem 0.5rem;
            border-radius: 0.25rem;
            margin-left: 0.5rem;
        }
        
        .language-box {
            background: #f3f4f6;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .language-label {
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 0.5rem;
        }
        
        .original-text {
            font-size: 1.25rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        
        .pronunciation {
            font-size: 0.875rem;
            color: #4b5563;
            margin-bottom: 0.5rem;
        }
        
        .translation {
            font-size: 1.5rem;
            color: #dc2626;
            font-weight: bold;
        }
        
        .modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            z-index: 50;
        }
        
        .modal-content {
            background: white;
            border-radius: 0.5rem;
            padding: 1.5rem;
            max-width: 24rem;
            width: 100%;
        }
        
        .share-text {
            background: #f3f4f6;
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1rem 0;
            white-space: pre-wrap;
            user-select: all;
        }
        
        .share-preview {
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .share-preview-title {
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .footer {
            text-align: center;
            margin-top: 2rem;
            font-size: 0.875rem;
            color: #6b7280;
        }
        
        .gif-container {
            margin: 1rem auto;
            text-align: center;
            position: relative;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .gif-container img {
            width: 100%;
            max-width: 400px;
            height: auto;
            max-height: 400px;
            object-fit: contain;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .loading-gif {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-radius: 50%;
            border-top: 5px solid #dc2626;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ê¹€ì¹˜ì‹¸ë‹¤êµ¬ ğŸŒ¶ï¸</h1>
            <p>ì² í•™ìê°€ ëŒ€ì‹  ë•Œë ¤ë“œë¦½ë‹ˆë‹¤</p>
        </div>
        
        <div id="app"></div>
        
        <div class="footer">
            <p>ã€ì¹¨ì‹¤ì—ì„œ ì½ëŠ” ì„œì–‘ì² í•™ì‚¬ã€ Ã— ê¹€ì¹˜ì‹¸ë‹¤êµ¬</p>
            <p class="mt-4">Made with ğŸ’• by í•˜ìœ¤ & ê°ë…ë‹˜</p>
            <p class="mt-4">
                <img src="https://developers.giphy.com/branch/master/static/header-logo-0fec0225d189bc0eae27dac3e3770582.gif" 
                     alt="Powered by GIPHY" 
                     style="height: 20px; vertical-align: middle; opacity: 0.7;">
            </p>
        </div>
    </div>
    
    <script>
        // ì „ì—­ ìƒíƒœ
        let state = {
            currentStep: 'intro',
            selectedTarget: '',
            targetName: '',
            selectedCharacter: null,
            selectedPhilosopher: null,
            slapCount: 0,
            isSlapping: false,
            showResult: false,
            showShareModal: false,
            shareId: null,
            currentGifUrl: ''
        };
        
        // Giphy slap GIF ì»¬ë ‰ì…˜
        const SLAP_GIFS = [
            'https://media.giphy.com/media/Zau0yrl17uzdK/giphy.gif',
            'https://media.giphy.com/media/xT0BKiwgIPGShJNi0g/giphy.gif',
            'https://media.giphy.com/media/14aUO0Mf7dWDXW/giphy.gif',
            'https://media.giphy.com/media/3o7TKwmnDgQb5jemjK/giphy.gif',
            'https://media.giphy.com/media/uqSU9IEYEKAbS/giphy.gif',
            'https://media.giphy.com/media/s5zXKfeXaa6ZO/giphy.gif',
            'https://media.giphy.com/media/wOXQvz3FwajVm/giphy.gif',
            'https://media.giphy.com/media/xT8qBpPTFsLrkrZahO/giphy.gif',
            'https://media.giphy.com/media/mEtSQlxqBtWWA/giphy.gif',
            'https://media.giphy.com/media/l3vQZ8ko4l0nvjm2Q/giphy.gif',
            'https://media.giphy.com/media/arbHBoiUWUgmc/giphy.gif',
            'https://media.giphy.com/media/iREUC7qrjN4vC/giphy.gif',
            'https://media.giphy.com/media/Ql5voX2wAVUYw/giphy.gif',
            'https://media.giphy.com/media/RdKjAkFTNZkWUGyRXF/giphy.gif',
            'https://media.giphy.com/media/3XlEk2RxPS1m8/giphy.gif',
            'https://media.giphy.com/media/l1ughbsd9qXz2s9SE/giphy.gif',
            'https://media.giphy.com/media/xUySTVQyBQfC5ZjdC0/giphy.gif',
            'https://media.giphy.com/media/VdWnBa31M6BeY1Iv11/giphy.gif',
            'https://media.giphy.com/media/3oEjI1erPMTMBFmNHi/giphy.gif',
            'https://media.giphy.com/media/26xBI73gWquCBBCDe/giphy.gif',
            'https://media.giphy.com/media/xUPGcxpCV81ebKh7Vu/giphy.gif',
            'https://media.giphy.com/media/u2RGgVCSo2oow/giphy.gif',
            'https://media.giphy.com/media/pDsCoECKh1Pa/giphy.gif',
            'https://media.giphy.com/media/rCftUAVPLExZC/giphy.gif',
            'https://media.giphy.com/media/Gtnf8ZENZY2EE/giphy.gif',
            'https://media.giphy.com/media/k61nOBRRBMxva/giphy.gif',
            'https://media.giphy.com/media/uA7iGzhqHGVtS/giphy.gif',
            'https://media.giphy.com/media/jnbePlxQpfVLO/giphy.gif',
            'https://media.giphy.com/media/y1WDIwAZRSmru/giphy.gif',
            'https://media.giphy.com/media/Vmvw0fS9vCQfe/giphy.gif'
        ];
        
        // íƒ€ê²Ÿ ë°ì´í„°
        const targets = {
            boss: { name: 'ìƒì‚¬', emoji: 'ğŸ‘”' },
            professor: { name: 'êµìˆ˜', emoji: 'ğŸ‘¨â€ğŸ«' },
            politician: { name: 'ì •ì¹˜ì¸', emoji: 'ğŸ¤µ' },
            friend: { name: 'ì¹œêµ¬', emoji: 'ğŸ‘¥' }
        };
        
        // ìºë¦­í„° í”„ë¦¬ì…‹
        const characters = {
            boss: [
                { id: 'boss40m', name: '40ëŒ€ ê¹€ë¶€ì¥', face: 'ğŸ˜ ', features: ['ë°°ë‚˜ì˜´', 'ëŒ€ë¨¸ë¦¬', 'ë„¥íƒ€ì´'] },
                { id: 'boss50m', name: '50ëŒ€ ë°•ìƒë¬´', face: 'ğŸ˜¤', features: ['í°ë¨¸ë¦¬', 'ì•ˆê²½', 'ê¶Œìœ„ì '] },
                { id: 'boss30f', name: '30ëŒ€ ìµœíŒ€ì¥', face: 'ğŸ˜’', features: ['ì¹¼ë‹¨ë°œ', 'ì°¨ê°€ì›€', 'ë…ì„¤ê°€'] }
            ],
            professor: [
                { id: 'prof50m', name: '50ëŒ€ ê¼°ëŒ€êµìˆ˜', face: 'ğŸ§', features: ['ì•ˆê²½', 'ìˆ˜ì—¼', 'ê¶Œìœ„ì '] },
                { id: 'prof60m', name: '60ëŒ€ ë…¸êµìˆ˜', face: 'ğŸ‘´', features: ['í°ë¨¸ë¦¬', 'ê³ ì§‘', 'ë³´ìˆ˜ì '] }
            ],
            politician: [
                { id: 'pol50m', name: '50ëŒ€ ì •ì¹˜ì¸', face: 'ğŸ¤¥', features: ['ê°€ë°œ', 'ë»”ë»”í•¨', 'ì–‘ë³µ'] }
            ],
            friend: [
                { id: 'friend20m', name: '20ëŒ€ MZí›„ë°°', face: 'ğŸ˜', features: ['ê±´ë°©ì§', 'ë¬´ë¡€í•¨', 'FM'] }
            ]
        };
        
        // ì² í•™ì ë°ì´í„°
        const philosophers = [
            {
                id: 'socrates',
                name: 'ì†Œí¬ë¼í…ŒìŠ¤',
                emoji: 'ğŸ§”',
                quote: 'ë„ˆ ìì‹ ì„ ì•Œë¼',
                original: 'Î“Î½á¿¶Î¸Î¹ ÏƒÎµÎ±Ï…Ï„ÏŒÎ½, Î¼Î±Î»Î¬ÎºÎ±!',
                pronunciation: 'ê·¸ë…¸í‹° ì„¸ì•„ìš°í†¤, ë§ë¼ì¹´!',
                slap: 'ë„ˆ ìì‹ ì´ ì¢†ë³‘ì‹ ì¸ ê±¸ ì•Œë¼!',
                language: 'ê³ ëŒ€ ê·¸ë¦¬ìŠ¤ì–´',
                free: true
            },
            {
                id: 'plato',
                name: 'í”Œë¼í†¤',
                emoji: 'ğŸ‘¨â€ğŸ“',
                quote: 'ë™êµ´ì˜ ë¹„ìœ ',
                original: 'ÎœÎ­Î½Îµ ÏƒÏ„Î¿ ÏƒÏ€Î®Î»Î±Î¹ÏŒ ÏƒÎ¿Ï…, Î³Î±Î¼Î·Î¼Î­Î½Îµ!',
                pronunciation: 'ë©”ë„¤ ìŠ¤í†  ìŠ¤í•„ë¼ì´ì˜¤ ìˆ˜, ê°€ë¯¸ë©”ë„¤!',
                slap: 'í‰ìƒ ë™êµ´ì—ì„œ ì¢†ì´ë‚˜ ë¹¨ê³  ìˆì–´ë¼!',
                language: 'ê³ ëŒ€ ê·¸ë¦¬ìŠ¤ì–´',
                free: true
            },
            {
                id: 'nietzsche',
                name: 'ë‹ˆì²´',
                emoji: 'ğŸ‘¨',
                quote: 'ì‹ ì€ ì£½ì—ˆë‹¤',
                original: 'Gott ist tot, und du bist ein Arschloch!',
                pronunciation: 'ê³ íŠ¸ ì´ìŠ¤íŠ¸ í† íŠ¸, ìš´íŠ¸ ë‘ ë¹„ìŠ¤íŠ¸ ì•„ì¸ ì•„ë¥´ì‰¬ë¡œí!',
                slap: 'ì‹ ì€ ì£½ì—ˆê³ , ë„ˆëŠ” ì¢†ê°™ì€ ë†ˆì´ë‹¤!',
                language: 'ë…ì¼ì–´',
                free: true
            },
            {
                id: 'aristotle',
                name: 'ì•„ë¦¬ìŠ¤í† í…”ë ˆìŠ¤',
                emoji: 'ğŸ“š',
                quote: 'ì¤‘ìš©ì´ ìµœê³ ì˜ ë•',
                original: 'Î•á¼¶ á¼„ÎºÏÏ‰Ï‚ á¼ Î»Î¯Î¸Î¹Î¿Ï‚!',
                pronunciation: 'ì—ì´ ì•„í¬ë¡œìŠ¤ ì¼ë¦¬í‹°ì˜¤ìŠ¤!',
                slap: 'ë„ˆëŠ” ê·¹ë„ë¡œ ë©ì²­í•œ ë³‘ì‹ ì´ë‹¤!',
                language: 'ê³ ëŒ€ ê·¸ë¦¬ìŠ¤ì–´',
                free: true
            },
            {
                id: 'descartes',
                name: 'ë°ì¹´ë¥´íŠ¸',
                emoji: 'ğŸ¤”',
                quote: 'ë‚˜ëŠ” ìƒê°í•œë‹¤ ê³ ë¡œ ì¡´ì¬í•œë‹¤',
                original: 'Tu ne penses pas, donc tu n\'es qu\'une merde!',
                pronunciation: 'íŠ€ ëŠ íŒ¡ìŠ¤ íŒŒ, ë™í¬ íŠ€ ë„¤ ìº‰ ë©”íë“œ!',
                slap: 'ë„ˆëŠ” ìƒê° ì•ˆ í•˜ë‹ˆê¹Œ ê·¸ëƒ¥ ë˜¥ë©ì–´ë¦¬ì•¼!',
                language: 'í”„ë‘ìŠ¤ì–´',
                free: true
            },
            {
                id: 'diogenes',
                name: 'ë””ì˜¤ê²Œë„¤ìŠ¤',
                emoji: 'ğŸ§™â€â™‚ï¸',
                quote: 'Î“Î±Î¼Ï!',
                original: 'Î“Î±Î¼Ï Ï„Î¿ ÎºÎµÏ†Î¬Î»Î¹ ÏƒÎ¿Ï…, Î¼Î±Î»Î¬ÎºÎ±!',
                pronunciation: 'ê°€ëª¨ í†  ì¼€íŒ”ë¦¬ ìˆ˜, ë§ë¼ì¹´!',
                slap: 'ë„¤ ëŒ€ê°€ë¦¬ë¥¼ ì¢†ë˜ê²Œ ë§Œë“¤ì–´ì£¼ê² ë‹¤!',
                language: 'ê³ ëŒ€ ê·¸ë¦¬ìŠ¤ì–´',
                free: false,
                premium: true
            },
            {
                id: 'kant',
                name: 'ì¹¸íŠ¸',
                emoji: 'ğŸ‘¨â€âš–ï¸',
                quote: 'ì •ì–¸ëª…ë ¹',
                original: 'Der kategorische Imperativ befiehlt dir: Verpiss dich!',
                pronunciation: 'ë°ì–´ ì¹´í…Œê³ ë¦¬ì…° ì„í˜ë¼í‹°í”„ ë² í•„íŠ¸ ë””ì–´: í˜ì–´í”¼ìŠ¤ ë””íˆ!',
                slap: 'ì •ì–¸ëª…ë ¹ì´ ë„ˆì—ê²Œ ëª…í•œë‹¤: êº¼ì ¸ë¼!',
                language: 'ë…ì¼ì–´',
                free: false,
                premium: true
            }
        ];
        
        // ë Œë”ë§ í•¨ìˆ˜
        function render() {
            const app = document.getElementById('app');
            app.innerHTML = '';
            
            const urlParams = new URLSearchParams(window.location.search);
            const viewId = urlParams.get('view');
            
            if (viewId) {
                renderSharedView(viewId);
                return;
            }
            
            switch(state.currentStep) {
                case 'intro':
                    renderIntro(app);
                    break;
                case 'target':
                    renderTargetSelection(app);
                    break;
                case 'character':
                    renderCharacterSelection(app);
                    break;
                case 'philosopher':
                    renderPhilosopherSelection(app);
                    break;
                case 'slap':
                    renderSlapScreen(app);
                    break;
            }
            
            if (state.showShareModal) {
                renderShareModal();
            }
        }
        
        // ì¸íŠ¸ë¡œ í™”ë©´
        function renderIntro(app) {
            app.innerHTML = `
                <div class="card text-center">
                    <div class="text-6xl mb-4">ğŸ’¥</div>
                    <h2 class="text-2xl mb-4"><b>ìŠ¤íŠ¸ë ˆìŠ¤ë¥¼ ì² í•™ìœ¼ë¡œ<br>ë‚ ë ¤ë²„ë¦¬ì„¸ìš”!</b></h2>
                    <p class="text-gray mb-6">ìœ„ëŒ€í•œ ì² í•™ìë“¤ì´<br>ë‹¹ì‹ ì„ ëŒ€ì‹ í•´ ê¹€ì¹˜ì‹¸ë‹¤êµ¬ë¥¼!</p>
                    
                    <div class="mb-4" style="height: 150px; overflow: hidden; border-radius: 0.5rem; background: #f3f4f6; display: flex; align-items: center; justify-content: center;">
                        <img src="https://media.giphy.com/media/xT0BKiwgIPGShJNi0g/giphy.gif" 
                             alt="ê¹€ì¹˜ì‹¸ë‹¤êµ¬ ë¯¸ë¦¬ë³´ê¸°" 
                             style="width: 100%; height: auto; opacity: 0.8;">
                    </div>
                    
                    <button class="btn" onclick="changeStep('target')">ì‹œì‘í•˜ê¸°</button>
                    <div class="mt-4 text-sm text-gray">
                        ëˆ„ì  ê¹€ì¹˜ì‹¸ë‹¤êµ¬: ${(12345 + state.slapCount).toLocaleString()}íšŒ
                    </div>
                </div>
            `;
        }
        
        // íƒ€ê²Ÿ ì„ íƒ í™”ë©´
        function renderTargetSelection(app) {
            app.innerHTML = `
                <div class="card">
                    <h2 class="text-2xl text-center mb-6"><b>ëˆ„êµ¬ë¥¼ ë•Œë¦´ê¹Œìš”?</b></h2>
                    <div class="target-grid">
                        ${Object.entries(targets).map(([key, target]) => `
                            <button class="target-btn ${state.selectedTarget === key ? 'selected' : ''}" 
                                    onclick="selectTarget('${key}')">
                                <div class="emoji">${target.emoji}</div>
                                <div><b>${target.name}</b></div>
                            </button>
                        `).join('')}
                    </div>
                    ${state.selectedTarget ? `
                        <div class="input-group">
                            <input type="text" 
                                   placeholder="${targets[state.selectedTarget].name} ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”"
                                   value="${state.targetName}"
                                   oninput="updateTargetName(this.value)"
                                   maxlength="10">
                        </div>
                        <button class="btn" style="width: 100%;" onclick="proceedToCharacter()">ë‹¤ìŒ</button>
                    ` : ''}
                </div>
            `;
        }
        
        // ìºë¦­í„° ì„ íƒ í™”ë©´
        function renderCharacterSelection(app) {
            app.innerHTML = `
                <div class="card">
                    <h2 class="text-2xl text-center mb-2"><b>ë¹„ìŠ·í•œ íƒ€ì…ì„ ê³¨ë¼ì£¼ì„¸ìš”</b></h2>
                    <p class="text-gray text-center mb-6">
                        ${state.targetName}ê³¼(ì™€) ë¹„ìŠ·í•œ ìºë¦­í„°
                    </p>
                    <div>
                        ${characters[state.selectedTarget]?.map((char) => `
                            <button class="philosopher-item" 
                                    onclick="selectCharacter('${char.id}')">
                                <div class="emoji">${char.face}</div>
                                <div style="flex: 1;">
                                    <div class="name">${char.name}</div>
                                    <div class="quote">${char.features.join(' Â· ')}</div>
                                </div>
                            </button>
                        `).join('')}
                    </div>
                    <button class="text-sm text-gray" onclick="changeStep('target')">â† ë‹¤ì‹œ ì„ íƒ</button>
                </div>
            `;
        }
        
        // ì² í•™ì ì„ íƒ í™”ë©´
        function renderPhilosopherSelection(app) {
            app.innerHTML = `
                <div class="card">
                    <h2 class="text-2xl text-center mb-6"><b>ì–´ë–¤ ì² í•™ìê°€ ë•Œë¦´ê¹Œìš”?</b></h2>
                    
                    <div class="philosopher-list">
                        ${philosophers.map(phil => `
                            <button class="philosopher-item ${phil.free ? '' : 'premium'}" 
                                    onclick="selectPhilosopher('${phil.id}')">
                                <span class="emoji">${phil.emoji}</span>
                                <div style="flex: 1;">
                                    <div class="name">
                                        ${phil.name}
                                        ${!phil.free ? '<span class="premium-badge">PREMIUM</span>' : ''}
                                    </div>
                                    <div class="quote">"${phil.quote}"</div>
                                    <div style="font-size: 0.75rem; color: #9ca3af; margin-top: 0.25rem;">
                                        ${phil.language}
                                    </div>
                                </div>
                            </button>
                        `).join('')}
                    </div>
                    
                    <button class="text-sm text-gray" onclick="changeStep('character')">â† ë‹¤ì‹œ ì„ íƒ</button>
                </div>
            `;
        }
        
        // ê¹€ì¹˜ì‹¸ë‹¤êµ¬ í™”ë©´
        function renderSlapScreen(app) {
            const phil = state.selectedPhilosopher;
            const char = state.selectedCharacter;
            
            app.innerHTML = `
                <div class="card text-center">
                    <div class="mb-6">
                        <div class="text-6xl mb-2">${phil.emoji}</div>
                        <h3 class="text-lg"><b>${phil.name}</b></h3>
                    </div>
                    
                    <div class="text-lg mb-4">
                        <span class="text-red">${state.targetName}</span>ì—ê²Œ
                    </div>
                    
                    ${!state.showResult ? `
                        ${!state.isSlapping ? `
                            <div class="text-6xl mb-4">ğŸ¥¬</div>
                            <button class="btn" onclick="doSlap()">
                                ê¹€ì¹˜ì‹¸ë‹¤êµ¬!
                            </button>
                        ` : `
                            <div class="gif-container">
                                ${state.currentGifUrl ? `
                                    <img src="${state.currentGifUrl}" 
                                         alt="ê¹€ì¹˜ì‹¸ë‹¤êµ¬!" />
                                ` : `
                                    <div class="loading-gif"></div>
                                    <p class="text-sm text-gray mt-4">ê¹€ì¹˜ì‹¸ë‹¤êµ¬ ì¤€ë¹„ì¤‘...</p>
                                `}
                            </div>
                            <div class="text-lg text-red animate-pulse">
                                ê¹€ì¹˜ì‹¸ë‹¤êµ¬ ì‘ë ¬ì¤‘...
                            </div>
                        `}
                    ` : `
                        <div>
                            <div class="text-6xl mb-4">ğŸ’¥</div>
                            
                            <div class="language-box">
                                <div class="language-label"><b>${phil.language}</b></div>
                                <div class="original-text">${phil.original}</div>
                                <div class="pronunciation">[${phil.pronunciation}]</div>
                                <div class="translation">"${phil.slap}"</div>
                            </div>
                            
                            <div class="text-sm text-gray mb-4">
                                ì´ë¹¨ ${Math.floor(Math.random() * 5) + 3}ê°œ ë‚ ì•„ê° ğŸ¦·âœ¨
                            </div>
                            
                            <div style="display: flex; gap: 0.75rem; justify-content: center; margin-bottom: 1rem;">
                                <button class="btn" onclick="doSlap()">
                                    ë‹¤ì‹œ ë•Œë¦¬ê¸°
                                </button>
                                <button class="btn btn-success" onclick="shareSlap()">
                                    ê³µìœ í•˜ê¸° ğŸš€
                                </button>
                            </div>
                            
                            <button class="mt-4 text-sm text-gray" onclick="resetApp()">ì²˜ìŒìœ¼ë¡œ</button>
                        </div>
                    `}
                    
                    ${state.slapCount > 0 && !state.showResult && !state.isSlapping ? `
                        <div class="mt-4 text-sm text-gray">
                            ${state.slapCount}ëŒ€ì§¸ ëŒ€ê¸°ì¤‘...
                        </div>
                    ` : ''}
                </div>
            `;
        }
        
        // ê³µìœ ëœ ë·° ë Œë”ë§
        function renderSharedView(shareId) {
            const app = document.getElementById('app');
            const shareDataStr = localStorage.getItem(shareId);
            
            if (!shareDataStr) {
                app.innerHTML = `
                    <div class="card text-center">
                        <div class="text-2xl mb-4">ğŸ˜…</div>
                        <h2 class="text-lg mb-4"><b>ê¹€ì¹˜ì‹¸ë‹¤êµ¬ê°€ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤!</b></h2>
                        <p class="text-gray mb-6">ì´ë¯¸ ë‚ ì•„ê°„ ê¹€ì¹˜ì‹¸ë‹¤êµ¬ì˜ˆìš”.</p>
                        <button class="btn" onclick="resetApp()">ìƒˆë¡œìš´ ê¹€ì¹˜ì‹¸ë‹¤êµ¬ ë‚ ë¦¬ê¸°</button>
                    </div>
                `;
                return;
            }
            
            const shareData = JSON.parse(shareDataStr);
            
            app.innerHTML = `
                <div class="card">
                    <div class="text-center mb-4">
                        <h2 class="text-2xl mb-2"><b>${shareData.target}ë‹˜ê»˜ ë‚ ì•„ì˜¨ ê¹€ì¹˜ì‹¸ë‹¤êµ¬!</b></h2>
                        <p class="text-gray">${shareData.philosopher.name}ë‹˜ì´ ë³´ë‚¸ ë©”ì‹œì§€</p>
                    </div>
                    
                    ${shareData.gifUrl ? `
                        <div class="gif-container mb-4">
                            <img src="${shareData.gifUrl}" alt="ê¹€ì¹˜ì‹¸ë‹¤êµ¬!" />
                        </div>
                    ` : `
                        <div class="text-6xl text-center mb-4">ğŸ’¥</div>
                    `}
                    
                    <div class="language-box">
                        <div class="language-label"><b>${shareData.philosopher.language}</b></div>
                        <div class="original-text">${shareData.philosopher.original}</div>
                        <div class="pronunciation">[${shareData.philosopher.pronunciation}]</div>
                        <div class="translation">"${shareData.philosopher.slap}"</div>
                    </div>
                    
                    <div class="text-center">
                        <button class="btn" onclick="resetApp()">ë‚˜ë„ ê¹€ì¹˜ì‹¸ë‹¤êµ¬ ë‚ ë¦¬ê¸°!</button>
                    </div>
                </div>
            `;
            
            setTimeout(() => {
                localStorage.removeItem(shareId);
            }, 5000);
        }
        
        // ê³µìœ  ëª¨ë‹¬
        function renderShareModal() {
            const modalDiv = document.createElement('div');
            modalDiv.className = 'modal';
            modalDiv.innerHTML = `
                <div class="modal-content">
                    <h3 class="text-lg mb-4"><b>ê¹€ì¹˜ì‹¸ë‹¤êµ¬ ê³µìœ í•˜ê¸°</b></h3>
                    
                    <div class="share-preview">
                        <div class="share-preview-title">ê³µìœ  ë§í¬ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!</div>
                        <div class="text-sm text-gray mt-2">
                            ë§í¬ë¥¼ ë°›ì€ ì‚¬ëŒì€ ê¹€ì¹˜ì‹¸ë‹¤êµ¬ ì• ë‹ˆë©”ì´ì…˜ê³¼<br>
                            ì² í•™ìì˜ ìš•ì„ ì „ì²´ í™”ë©´ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤!
                        </div>
                    </div>
                    
                    <div class="share-text">
${state.selectedPhilosopher.name}ì´(ê°€) ${state.targetName}ì—ê²Œ:

[${state.selectedPhilosopher.language}]
${state.selectedPhilosopher.original}
[${state.selectedPhilosopher.pronunciation}]

"${state.selectedPhilosopher.slap}"

ê¹€ì¹˜ì‹¸ë‹¤êµ¬ ${state.slapCount}ëŒ€ì§¸! ğŸŒ¶ï¸ğŸ’¥

ğŸ‘‡ ë§í¬ í´ë¦­ì‹œ ê¹€ì¹˜ì‹¸ë‹¤êµ¬ ì¬ìƒ!
${state.shareLink}
                    </div>
                    
                    <p class="text-sm text-gray mb-4">
                        ìœ„ ë‚´ìš©ì„ ì „ì²´ ì„ íƒí•´ì„œ ë³µì‚¬í•˜ì„¸ìš”!
                    </p>
                    
                    <button class="btn" style="width: 100%;" onclick="closeShareModal()">ë‹«ê¸°</button>
                </div>
            `;
            document.body.appendChild(modalDiv);
        }
        
        // ëœë¤ GIF ì„ íƒ í•¨ìˆ˜
        function getRandomSlapGif() {
            const randomIndex = Math.floor(Math.random() * SLAP_GIFS.length);
            return SLAP_GIFS[randomIndex];
        }
        
        // ìƒíƒœ ë³€ê²½ í•¨ìˆ˜ë“¤
        function changeStep(step) {
            state.currentStep = step;
            render();
        }
        
        function selectTarget(target) {
            state.selectedTarget = target;
            render();
        }
        
        function updateTargetName(name) {
            state.targetName = name;
        }
        
        function proceedToCharacter() {
            if (!state.targetName.trim()) {
                alert('ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }
            changeStep('character');
        }
        
        function selectCharacter(charId) {
            const char = characters[state.selectedTarget].find(c => c.id === charId);
            state.selectedCharacter = char;
            changeStep('philosopher');
        }
        
        function selectPhilosopher(id) {
            const phil = philosophers.find(p => p.id === id);
            if (phil.free) {
                state.selectedPhilosopher = phil;
                changeStep('slap');
            } else {
                alert('í”„ë¦¬ë¯¸ì—„ ì² í•™ìì…ë‹ˆë‹¤! ğŸŒŸ\n\nê³§ ì˜¤í”ˆ ì˜ˆì •!');
            }
        }
        
        async function doSlap() {
            state.isSlapping = true;
            state.showResult = false;
            state.slapCount++;
            
            // ëœë¤ GIF ì„ íƒ
            state.currentGifUrl = getRandomSlapGif();
            
            render();
            
            // GIF ì¬ìƒ í›„ ê²°ê³¼ í‘œì‹œ
            setTimeout(() => {
                state.isSlapping = false;
                state.showResult = true;
                render();
            }, 3000);
        }
        
        function generateShareId() {
            return 'slap_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }
        
        function generateShareLink() {
            const shareId = generateShareId();
            state.shareId = shareId;
            
            const shareData = {
                id: shareId,
                target: state.targetName,
                character: state.selectedCharacter,
                philosopher: state.selectedPhilosopher,
                gifUrl: state.currentGifUrl,
                timestamp: Date.now()
            };
            
            localStorage.setItem(shareId, JSON.stringify(shareData));
            
            return `${window.location.origin}${window.location.pathname}?view=${shareId}`;
        }
        
        function shareSlap() {
            state.shareLink = generateShareLink();
            state.showShareModal = true;
            render();
        }
        
        function closeShareModal() {
            state.showShareModal = false;
            document.querySelector('.modal').remove();
        }
        
        function resetApp() {
            window.history.replaceState({}, document.title, window.location.pathname);
            
            state = {
                currentStep: 'intro',
                selectedTarget: '',
                targetName: '',
                selectedCharacter: null,
                selectedPhilosopher: null,
                slapCount: state.slapCount,
                isSlapping: false,
                showResult: false,
                showShareModal: false,
                shareId: null,
                currentGifUrl: ''
            };
            render();
        }
        
        // ì´ˆê¸°í™”
        window.onload = function() {
            render();
            console.log('ê¹€ì¹˜ì‹¸ë‹¤êµ¬ ì¤€ë¹„ ì™„ë£Œ! ğŸŒ¶ï¸');
        };
    </script>
</body>
</html>
